<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HL7 Viewer</title>
    <link rel="icon" type="image/png" href="./favicon.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Syne:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="./scripts/tailwind.config.js"></script>
    <link rel="stylesheet" href="./styles/main.css" />
  </head>
  <body
    class="
      bg-custom-bg
      text-custom-text
      font-mono
      h-screen
      flex flex-col
      overflow-hidden
    "
  >
    <header
      class="
        py-2
        sm:py-[13px]
        px-3
        sm:px-6
        bg-custom-surface
        border-b border-custom-border
        flex
        items-center
        gap-2
        sm:gap-3.5
        flex-shrink-0
      "
    >
      <div
        class="
          font-syne font-extrabold
          text-sm
          sm:text-[17px]
          text-custom-text-bright
        "
      >
        HL7 <span class="text-custom-accent">Viewer</span>
      </div>
      <button
        id="themeToggle"
        class="
          ml-auto
          w-8
          h-8
          sm:w-9 sm:h-9
          flex
          items-center
          justify-center
          border border-custom-border
          rounded-md
          cursor-pointer
          transition-all
          duration-150
          bg-transparent
          text-custom-text-dim
          hover:text-custom-text
          hover:border-custom-text-dim
          hover:bg-custom-surface2
        "
        aria-label="Toggle theme"
        onclick="toggleTheme()"
      >
        <svg
          id="moonIcon"
          class="w-4 h-4 sm:w-5 sm:h-5"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
          />
        </svg>
        <svg
          id="sunIcon"
          class="w-4 h-4 sm:w-5 sm:h-5 hidden"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
          />
        </svg>
      </button>
    </header>

    <div class="flex flex-col lg:flex-row flex-1 overflow-hidden">
      <!-- Left: Editable Message -->
      <div
        class="w-full flex flex-col overflow-hidden lg:flex-1 h-1/2 lg:h-auto"
      >
        <div
          class="
            py-2
            sm:py-[9px]
            px-3
            sm:px-4
            bg-custom-surface
            border-b border-custom-border
            text-[9px]
            sm:text-[10px]
            font-medium
            tracking-[1.2px]
            sm:tracking-[1.5px]
            text-custom-text-dim
            uppercase
            flex-shrink-0 flex
            items-center
            gap-1.5
            sm:gap-2
          "
        >
          <span
            class="
              w-1
              h-1
              sm:w-1.5 sm:h-1.5
              rounded-full
              bg-custom-accent
              shadow-[0_0_6px_#1eb8e0]
            "
          ></span>
          <span class="hidden sm:inline">MESSAGE EDITOR</span>
          <span class="sm:hidden">EDITOR</span>
        </div>
        <div
          class="
            py-1.5
            sm:py-[7px]
            px-3
            sm:px-4
            bg-[rgba(30,184,224,0.05)]
            border-b border-[rgba(30,184,224,0.1)]
            text-custom-text-dim text-[9px]
            sm:text-[10px]
            flex-shrink-0
            hidden
            sm:flex
            items-center
            gap-1.5
          "
          id="clickHint"
        >
          ↖ <span class="text-custom-accent">Click any line</span> to inspect
          its fields
        </div>
        <div class="flex-1 relative overflow-hidden flex">
          <div
            class="
              w-[28px]
              sm:w-[38px]
              bg-custom-surface
              border-r border-custom-border
              py-2
              sm:py-3.5
              overflow-hidden
              flex-shrink-0
              pointer-events-none
            "
            id="lineNumbers"
          ></div>
          <div
            class="
              absolute
              left-[28px]
              sm:left-[38px]
              top-0
              right-0
              bottom-0
              bg-custom-bg
              z-0
            "
          ></div>
          <div
            class="
              absolute
              left-[28px]
              sm:left-[38px]
              right-0
              pointer-events-none
              bg-[rgba(30,184,224,0.3)]
              border-l-2
              sm:border-l-[3px]
              border-custom-accent
              transition-all
              duration-75
              ease-out
              hidden
            "
            id="lineHighlight"
          ></div>
          <textarea
            id="hl7input"
            wrap="off"
            placeholder="Paste or type your HL7 message here...&#10;&#10;MSH|^~\&|SendApp|SendFac|RecApp|RecFac|20230915120000||ADT^A01|MSG001|P|2.5&#10;PID|1||123456^^^Hospital^MR||Doe^John^A||19800101|M&#10;PV1|1|I|ICU^101^A&#10;&#10;Click a line to inspect its fields.&#10;Edits are reflected instantly."
            class="
              flex-1
              bg-transparent
              text-custom-text
              font-mono
              text-[10px]
              leading-[1.7]
              py-2
              sm:py-3.5
              pr-2
              sm:pr-3.5
              pl-1.5
              sm:pl-2.5
              border-none
              resize-none
              outline-none
              overflow-x-auto overflow-y-auto
              whitespace-pre
              caret-custom-accent
              relative
              z-[1]
              scrollbar-thin
              placeholder:text-custom-text-dim placeholder:text-[9px]
              sm:placeholder:text-[11px]
            "
          ></textarea>
        </div>
        <div
          class="
            py-1
            sm:py-1.5
            px-3
            sm:px-4
            bg-[rgba(255,107,53,0.1)]
            border-t border-[rgba(255,107,53,0.2)]
            text-custom-accent3 text-[9px]
            sm:text-[10px]
            flex-shrink-0
            hidden
          "
          id="errorBar"
        >
          ⚠ First segment should be MSH
        </div>
        <div
          class="
            py-2
            sm:py-[9px]
            px-2
            sm:px-3.5
            bg-custom-surface
            border-t
            lg:border-t
            border-custom-border
            flex
            gap-1.5
            sm:gap-2
            flex-shrink-0
            items-center
            flex-wrap
            sm:flex-nowrap
          "
        >
          <button
            class="
              font-mono
              text-[10px]
              sm:text-[11px]
              font-medium
              py-1
              sm:py-1.5
              px-2.5
              sm:px-3.5
              border border-custom-border
              rounded-[3px]
              cursor-pointer
              transition-all
              duration-150
              bg-transparent
              text-custom-text-dim
              hover:text-custom-text hover:border-custom-text-dim
            "
            onclick="loadSample()"
          >
            Load Sample
          </button>
          <button
            class="
              font-mono
              text-[10px]
              sm:text-[11px]
              font-medium
              py-1
              sm:py-1.5
              px-2.5
              sm:px-3.5
              border border-custom-border
              rounded-[3px]
              cursor-pointer
              transition-all
              duration-150
              bg-transparent
              text-custom-text-dim
              hover:text-custom-text hover:border-custom-text-dim
            "
            onclick="clearAll()"
          >
            Clear
          </button>
          <span
            id="copyrightText"
            class="
              text-[9px]
              sm:text-[9.5px]
              text-custom-text-dim
              mx-auto
              lg:mx-0
            "
          >
            &copy; <span id="currentYear"></span> HL7 Viewer by
            <a
              href="https://codebynithin.com"
              target="_blank"
              class="text-custom-accent hover:text-custom-accent3"
            >
              CodeByNithin
            </a>
          </span>
          <span
            class="hidden lg:inline ml-auto text-[9.5px] text-custom-text-dim"
          >
            Click any line · Edits update instantly
          </span>
        </div>
      </div>

      <!-- Right: Field Details -->
      <div
        class="
          w-full
          flex flex-col
          overflow-hidden
          lg:flex-1 lg:max-w-[480px]
          h-1/2
          lg:h-auto
          bg-custom-surface2
          border-t
          lg:border-t-0 lg:border-l
          border-custom-border
        "
      >
        <div
          class="
            py-2
            sm:py-[9px]
            px-3
            sm:px-4
            bg-custom-surface
            border-b border-custom-border
            text-[9px]
            sm:text-[10px]
            font-medium
            tracking-[1.2px]
            sm:tracking-[1.5px]
            text-custom-text-dim
            uppercase
            flex-shrink-0 flex
            items-center
            gap-1.5
            sm:gap-2
          "
        >
          <span
            class="
              w-1
              h-1
              sm:w-1.5 sm:h-1.5
              rounded-full
              bg-custom-accent3
              shadow-[0_0_6px_#ff6b35]
            "
          ></span>
          <span class="hidden sm:inline">SEGMENT DETAIL</span>
          <span class="sm:hidden">DETAIL</span>
        </div>
        <div class="flex-1 overflow-y-auto scrollbar-thin" id="fieldsContent">
          <div
            class="
              flex flex-col
              items-center
              justify-center
              gap-2
              sm:gap-2.5
              text-custom-text-dim text-[10px]
              sm:text-[11px]
              leading-6
              sm:leading-8
              text-center
              py-6
              sm:py-10
              px-6
              sm:px-10
              h-full
            "
          >
            <div class="text-[32px] sm:text-[40px] opacity-20">◈</div>
            Paste a message on the left,<br />then click any segment line
          </div>
        </div>
      </div>
    </div>

    <script src="scripts/main.js"></script>
  </body>
</html>
